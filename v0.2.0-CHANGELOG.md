# Changelog

All notable changes to the Qwen Proxy VSCode Extension will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Planned
- Improved error handling
- Rate limiting
- Response caching
- Model selection
- Conversation history
- Performance optimizations

### Added
- **Automated Endpoint Tests**: Introduced Jest and Supertest-based automated tests for server endpoints (`/health`, `/v1/models`, `/status`, `/v1/chat/completions`). Each endpoint has its own test file in the `test/` directory for clarity and maintainability.
- **VSCode Mocking for Tests**: Added Jest manual mock for the `vscode` module to enable isolated server testing.
- **Testing Documentation**: Updated setup-dev-guide.md with instructions for running and maintaining automated tests.

## [0.3.0] - Unreleased

### Added
- (Add new features here)

### Changed
- (Add changes here)

### Fixed
- (Add bug fixes here)

## [0.1.2] - 2025-06-21

### Added
- **Cookie Persistence**: The Qwen client now saves and loads cookies to maintain login sessions across restarts.
- **Manual Login Command**: Added a "Qwen Proxy: Open Browser to Login" command to easily open a non-headless browser for manual authentication.
- **Clear Cookies Command**: Added a "Qwen Proxy: Clear Cookies" command.
- **Streaming Support**: Implemented response streaming from the Qwen web interface.
- **VSCode Extension Context**: The client now accepts an `ExtensionContext` for better integration with VSCode's state and storage.

### Changed
- **Refactored QwenClient**: Major refactoring of the Qwen client for better organization. Replaced `playwright-core` with `puppeteer` to match project dependencies. The client is now more robust with distinct `initialize` and `cleanup` methods.
- **Configuration Update**: The `openBrowser` command now correctly uses `await` when updating the configuration to prevent race conditions.
- **Robust Cleanup**: The `cleanup` method now uses a `try...finally` block to ensure the client state is reset correctly, even if errors occur.
- **TypeScript Configuration**: Corrected TypeScript configuration to allow for DOM types, resolving compilation errors.

## [0.1.0] - 2024-07-25

### Added
- Initial release of the Qwen Proxy extension.
- Core proxy server functionality with Express.
- OpenAI-compatible endpoints: `/v1/chat/completions` and `/v1/models`.
- Puppeteer-based client for interacting with the Qwen website.
- VS Code commands: Start, Stop, Status.
- Configuration options for port, Qwen URL, headless mode, and auto-start.
- Status bar item to show the proxy's status.
- Session persistence via cookies to remember login state.
